(this["webpackJsonpredux-essentials-example"]=this["webpackJsonpredux-essentials-example"]||[]).push([[0],{1139:function(e,t){},1142:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(31),o=n.n(c),s=(n(71),n(9)),i=n(5),u=n(1),l=n(18),m=n(7),d=n.n(m),p=n(15),f=n(17),b=n(4),E=n(19),h=n(65),O=["body"];function j(e){return v.apply(this,arguments)}function v(){return(v=Object(f.a)(d.a.mark((function e(t){var n,a,r,c,o,s,i,u=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:{},a=n.body,r=Object(h.a)(n,O),c={"Content-Type":"application/json"},o=Object(E.a)(Object(E.a)({method:a?"POST":"GET"},r),{},{headers:Object(E.a)(Object(E.a)({},c),r.headers)}),a&&(o.body=JSON.stringify(a)),e.prev=4,e.next=7,window.fetch(t,o);case 7:return i=e.sent,e.next=10,i.json();case 10:if(s=e.sent,!i.ok){e.next=13;break}return e.abrupt("return",s);case 13:throw new Error(i.statusText);case 16:return e.prev=16,e.t0=e.catch(4),e.abrupt("return",Promise.reject(e.t0.message?e.t0.message:s));case 19:case"end":return e.stop()}}),e,null,[[4,16]])})))).apply(this,arguments)}j.get=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return j(e,Object(E.a)(Object(E.a)({},t),{},{method:"GET"}))},j.post=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return j(e,Object(E.a)(Object(E.a)({},n),{},{body:t}))};var g,y=Object(b.c)({sortComparer:function(e,t){return t.date.localeCompare(e.date)}}),x=Object(b.b)("notifications/fetchNotifications",function(){var e=Object(f.a)(d.a.mark((function e(t,n){var a,r,c,o,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getState,r=S(a()),c=Object(p.a)(r,1),o=c[0],s=o?o.date:"",e.next=6,j.get("/fakeApi/notifications?since=".concat(s));case 6:return i=e.sent,e.abrupt("return",i.notifications);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),w=Object(b.d)({name:"notifications",initialState:y.getInitialState(),reducers:{allNotificationsRead:function(e,t){Object.values(e.entities).forEach((function(e){e.read=!0}))}},extraReducers:Object(l.a)({},x.fulfilled,(function(e,t){Object.values(e.entities).forEach((function(e){e.isNew=!e.read})),y.upsertMany(e,t.payload)}))}),N=w.actions.allNotificationsRead,k=w.reducer,S=y.getSelectors((function(e){return e.notifications})).selectAll,I=function(){var e,t=Object(u.b)(),n=Object(u.c)(S).filter((function(e){return!e.read})).length;return n>0&&(e=r.a.createElement("span",{className:"badge"},n)),r.a.createElement("nav",null,r.a.createElement("section",null,r.a.createElement("h1",null,"My React Redux Demo"),r.a.createElement("div",{className:"navContent"},r.a.createElement("div",{className:"navLinks"},r.a.createElement(s.b,{to:"/"},"Posts"),r.a.createElement(s.b,{to:"/users"},"Users"),r.a.createElement(s.b,{to:"/notifications"},"Notifications ",e)),r.a.createElement("button",{className:"button",onClick:function(){t(x())}},"Refresh Notifications"))))},C=n(32),A=Object(b.c)({sortComparer:function(e,t){return t.date.localeCompare(e.date)}}),P=A.getInitialState({status:"idle",error:null}),T=Object(b.b)("posts/fetchPosts",Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/fakeApi/posts");case 2:return t=e.sent,e.abrupt("return",t.posts);case 4:case"end":return e.stop()}}),e)})))),M=Object(b.b)("posts/addNewPost",function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.post("/fakeApi/posts",{post:t});case 2:return n=e.sent,e.abrupt("return",n.post);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),R=Object(b.d)({name:"posts",initialState:P,reducers:{reactionAdded:function(e,t){var n=t.payload,a=n.postId,r=n.reaction,c=e.entities[a];c&&c.reactions[r]++},postUpdated:function(e,t){var n=t.payload,a=n.id,r=n.title,c=n.content,o=e.entities[a];o&&(o.title=r,o.content=c)}},extraReducers:(g={},Object(l.a)(g,T.pending,(function(e,t){e.status="loading"})),Object(l.a)(g,T.fulfilled,(function(e,t){e.status="succeeded",A.upsertMany(e,t.payload)})),Object(l.a)(g,T.rejected,(function(e,t){e.status="failed",e.error=t.payload})),Object(l.a)(g,M.fulfilled,A.addOne),g)}),U=R.actions,D=(U.postAdded,U.postUpdated),F=U.reactionAdded,L=R.reducer,B=A.getSelectors((function(e){return e.posts})),Y=B.selectAll,q=B.selectById,z=B.selectIds,J=Object(C.a)([Y,function(e,t){return t}],(function(e,t){return e.filter((function(e){return e.user===t}))})),G=function(e){var t=e.match.params.postId,n=Object(u.c)((function(e){return q(e,t)})),c=Object(a.useState)(n.title),o=Object(p.a)(c,2),s=o[0],l=o[1],m=Object(a.useState)(n.content),d=Object(p.a)(m,2),f=d[0],b=d[1],E=Object(u.b)(),h=Object(i.g)();return r.a.createElement("section",null,r.a.createElement("h2",null,"Edit Post"),r.a.createElement("form",null,r.a.createElement("label",{htmlFor:"postTitle"},"Post Title:"),r.a.createElement("input",{type:"text",id:"postTitle",name:"postTitle",placeholder:"What's on your mind?",value:s,onChange:function(e){return l(e.target.value)}}),r.a.createElement("label",{htmlFor:"postContent"},"Content:"),r.a.createElement("textarea",{id:"postContent",name:"postContent",value:f,onChange:function(e){return b(e.target.value)}})),r.a.createElement("button",{type:"button",onClick:function(){s&&f&&(E(D({id:t,title:s,content:f})),h.push("/posts/".concat(t)))}},"Save Post"))},W=Object(b.c)(),V=W.getInitialState(),H=Object(b.b)("users/fetchUsers",Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/fakeApi/users");case 2:return t=e.sent,e.abrupt("return",t.users);case 4:case"end":return e.stop()}}),e)})))),K=Object(b.d)({name:"users",initialState:V,reducers:{},extraReducers:Object(l.a)({},H.fulfilled,W.setAll)}).reducer,Q=W.getSelectors((function(e){return e.users})),X=Q.selectAll,Z=Q.selectById,$=function(e){var t=e.userId,n=Object(u.c)((function(e){return Z(e,t)}));return r.a.createElement("span",null,"by ",n?n.name:"Unknown author")},_=n(1144),ee=n(1143),te=function(e){var t=e.timestamp,n="";if(t){var a=Object(_.a)(t),c=Object(ee.a)(a);n="".concat(c," ago")}return r.a.createElement("span",{title:t},r.a.createElement("i",null," (",n,")"))},ne={thumbsUp:"\ud83d\udc4d",hooray:"\ud83c\udf89",heart:"\u2764\ufe0f",rocket:"\ud83d\ude80",eyes:"\ud83d\udc40"},ae=function(e){var t=e.post,n=Object(u.b)(),a=Object.entries(ne).map((function(e){var a=Object(p.a)(e,2),c=a[0],o=a[1];return r.a.createElement("button",{key:c,type:"button",className:"muted-button reaction-button",onClick:function(){return n(F({postId:t.id,reaction:c}))}},o," ",t.reactions[c])}));return r.a.createElement("div",null,a)},re=function(e){var t=e.postId,n=Object(u.c)((function(e){return q(e,t)}));return r.a.createElement("article",{className:"post-excerpt",key:n.id},r.a.createElement("h3",null,n.title),r.a.createElement("div",null,r.a.createElement($,{userId:n.user}),r.a.createElement(te,{timestamp:n.date})),r.a.createElement("p",{className:"post-content"},n.content.substring(0,100)),r.a.createElement(ae,{post:n}),r.a.createElement(s.b,{to:"/posts/".concat(n.id),className:"button muted-button"},"View Post"))},ce=function(){var e,t=Object(u.b)(),n=Object(u.c)(z),c=Object(u.c)((function(e){return e.posts.status})),o=Object(u.c)((function(e){return e.posts.error}));return Object(a.useEffect)((function(){"idle"===c&&t(T())}),[c,t]),"loading"===c?e=r.a.createElement("div",{className:"loader"},"Loading..."):"succeeded"===c?e=n.map((function(e){return r.a.createElement(re,{key:e,postId:e})})):"error"===c&&(e=r.a.createElement("div",null,o)),r.a.createElement("section",{className:"posts-list"},r.a.createElement("h2",null,"Posts"),e)},oe=function(){var e=Object(a.useState)(""),t=Object(p.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(""),s=Object(p.a)(o,2),i=s[0],l=s[1],m=Object(a.useState)(""),E=Object(p.a)(m,2),h=E[0],O=E[1],j=Object(a.useState)("idle"),v=Object(p.a)(j,2),g=v[0],y=v[1],x=Object(u.b)(),w=Object(u.c)(X),N=[n,i,h].every(Boolean)&&"idle"===g,k=function(){var e=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!N){e.next=18;break}return e.prev=1,y("pending"),e.next=5,x(M({title:n,content:i,user:h}));case 5:t=e.sent,Object(b.f)(t),c(""),l(""),O(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("Failed to save the post: ",e.t0);case 15:return e.prev=15,y("idle"),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[1,12,15,18]])})));return function(){return e.apply(this,arguments)}}(),S=w.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}));return r.a.createElement("section",null,r.a.createElement("h2",null,"Add a New Post"),r.a.createElement("form",null,r.a.createElement("label",{htmlFor:"postTitle"},"Post Title:"),r.a.createElement("input",{type:"text",id:"postTitle",name:"postTitle",placeholder:"What's on your mind?",value:n,onChange:function(e){return c(e.target.value)}}),r.a.createElement("label",{htmlFor:"postAuthor"},"Author:"),r.a.createElement("select",{id:"postAuthor",value:h,onChange:function(e){return O(e.target.value)}},r.a.createElement("option",{value:""}),S),r.a.createElement("label",{htmlFor:"postContent"},"Content:"),r.a.createElement("textarea",{id:"postContent",name:"postContent",value:i,onChange:function(e){return l(e.target.value)}}),r.a.createElement("button",{type:"button",onClick:k,disabled:!N},"Save Post")))},se=n(53),ie=n.n(se),ue=function(e){var t=e.match.params.postId,n=Object(u.c)((function(e){return q(e,t)})),a=ie()(n.date).format("MMMM Do YYYY, h:mm:ss a");return n?r.a.createElement("section",null,r.a.createElement("article",{className:"post"},r.a.createElement("h2",null,n.title),r.a.createElement("p",null,a," \xa0(",r.a.createElement(te,{timestamp:n.date}),")"),r.a.createElement($,{userId:n.user}),r.a.createElement("p",{className:"post-content"},n.content),r.a.createElement(ae,{post:n}),r.a.createElement("br",null),r.a.createElement(s.b,{to:"/editPost/".concat(n.id),className:"button"},"Edit Post"))):r.a.createElement("section",null,r.a.createElement("h2",null,"Post not found!"))},le=function(){var e=Object(u.c)(X).map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(s.b,{to:"/users/".concat(e.id)},e.name))}));return r.a.createElement("section",null,r.a.createElement("h2",null,"Users"),r.a.createElement("ul",null,e))},me=function(e){var t=e.match.params.userId,n=Object(u.c)((function(e){return Z(e,t)})),a=Object(u.c)((function(e){return J(e,t)})).map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(s.b,{to:"/posts/".concat(e.id)},e.title))}));return r.a.createElement("section",null,r.a.createElement("h2",null,n.name),r.a.createElement("ul",null,a))},de=n(54),pe=n.n(de),fe=function(){var e=Object(u.b)(),t=Object(u.c)(S),n=Object(u.c)(X);Object(a.useEffect)((function(){e(N())}));var c=t.map((function(e){var t=Object(_.a)(e.date),a=Object(ee.a)(t),c=n.find((function(t){return t.id===e.user}))||{name:"Unknown User"},o=pe()("notification",{new:e.isNew});return r.a.createElement("div",{key:e.id,className:o},r.a.createElement("div",null,r.a.createElement("b",null,c.name)," ",e.message),r.a.createElement("div",{title:e.date},r.a.createElement("i",null,a," ago")))}));return r.a.createElement("section",{className:"notificationsList"},r.a.createElement("h2",null,"Notifications"),c)};var be,Ee=function(){return r.a.createElement(s.a,null,r.a.createElement(I,null),r.a.createElement("div",{className:"App"},r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/notifications",component:fe}),r.a.createElement(i.b,{exact:!0,path:"/",render:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe,null),r.a.createElement(ce,null))}}),r.a.createElement(i.b,{exact:!0,path:"/posts/:postId",component:ue}),r.a.createElement(i.b,{exact:!0,path:"/editPost/:postId",component:G}),r.a.createElement(i.b,{exact:!0,path:"/users",component:le}),r.a.createElement(i.b,{exact:!0,path:"/users/:userId",component:me}),r.a.createElement(i.a,{to:"/"}))))},he=Object(b.a)({reducer:{posts:L,users:K,notifications:k}}),Oe=n(64),je=n(8),ve=n(20),ge=n.n(ve),ye=n(28),xe=n(44),we=n.n(xe),Ne=je.c.extend({serializeIds:"always"}),ke=we()(),Se=localStorage.getItem("randomTimestampSeed");function Ie(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(ke()*(t-e+1))+e}Se?be=new Date(Se):(Se=(be=new Date).toISOString(),localStorage.setItem("randomTimestampSeed",Se)),ke=we()(Se),Object(ye.setRandom)(ke),ge.a.seed(be.getTime());var Ce=function(e){return e[Ie(0,e.length-1)]},Ae=["poked you","says hi!","is glad we're friends","sent you a gift"];new je.d({routes:function(){this.namespace="fakeApi",this.timing=1e3,this.resource("users"),this.resource("posts"),this.resource("comments");var e=this;this.post("/posts",(function(t,n){var a=this.normalizedRequestAttrs();a.date=(new Date).toISOString();var r=t.users.find(a.userId);if(a.user=r,"error"===a.content)throw new Error("Could not save the post!");return e.create("post",a)})),this.get("/posts/:postId/comments",(function(e,t){return e.posts.find(t.params.postId).comments})),this.get("/notifications",(function(e,t){var n,a=Ie(1,5),r=new Date;return t.queryParams.since?n=Object(_.a)(t.queryParams.since):(n=new Date(r.valueOf())).setMinutes(n.getMinutes()-15),{notifications:Object(Oe.a)(Array(a)).map((function(){var t=Ce(e.db.users),a=Ce(Ae);return{id:Object(b.e)(),date:ge.a.date.between(n,r).toISOString(),message:a,user:t.id,read:!1,isNew:!0}}))}}))},models:{user:je.b.extend({posts:Object(je.g)()}),post:je.b.extend({user:Object(je.f)(),comments:Object(je.g)()}),comment:je.b.extend({post:Object(je.f)()}),notification:je.b.extend({})},factories:{user:je.a.extend({id:function(){return Object(b.e)()},firstName:function(){return ge.a.name.firstName()},lastName:function(){return ge.a.name.lastName()},name:function(){return ge.a.name.findName(this.firstName,this.lastName)},username:function(){return ge.a.internet.userName(this.firstName,this.lastName)},afterCreate:function(e,t){t.createList("post",3,{user:e})}}),post:je.a.extend({id:function(){return Object(b.e)()},title:function(){return Object(ye.sentence)()},date:function(){return ge.a.date.recent(7)},content:function(){return Object(ye.article)(1)},reactions:function(){return{thumbsUp:0,hooray:0,heart:0,rocket:0,eyes:0}},afterCreate:function(e,t){},user:Object(je.e)()}),comment:je.a.extend({id:function(){return Object(b.e)()},date:function(){return ge.a.date.past(2)},text:function(){return Object(ye.paragraph)()},post:Object(je.e)()})},serializers:{user:Ne,post:Ne,comment:Ne},seeds:function(e){e.createList("user",3)}}),he.dispatch(H()),o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(u.a,{store:he},r.a.createElement(Ee,null))),document.getElementById("root"))},66:function(e,t,n){e.exports=n(1142)},71:function(e,t,n){}},[[66,1,2]]]);
//# sourceMappingURL=main.ddd43ed1.chunk.js.map